<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple WebSocket Test</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>
    <h1>ê°„ë‹¨í•œ WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
    <div>
        <button onclick="testConnection()">SockJS ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <button onclick="testStompConnection()">STOMP ì—°ê²° í…ŒìŠ¤íŠ¸</button>
    </div>
    <div>
        <h3>ë¡œê·¸:</h3>
        <div id="log" style="border: 1px solid #ccc; height: 400px; overflow-y: scroll; padding: 10px;"></div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function testConnection() {
            log('ğŸ”„ SockJS ì—°ê²° ì‹œë„...');
            
            try {
                const socket = new SockJS('http://localhost:8080/ws-stomp');
                
                socket.onopen = function(event) {
                    log('âœ… SockJS ì—°ê²° ì„±ê³µ!');
                    socket.close();
                };
                
                socket.onerror = function(error) {
                    log('âŒ SockJS ì—°ê²° ì‹¤íŒ¨: ' + error);
                };
                
                socket.onclose = function(event) {
                    log('ğŸ”Œ SockJS ì—°ê²° ì¢…ë£Œ: code=' + event.code + ', reason=' + event.reason);
                };
                
            } catch (error) {
                log('âŒ SockJS ìƒì„± ì‹¤íŒ¨: ' + error);
            }
        }
        
        function testStompConnection() {
            log('ğŸ”„ STOMP ì—°ê²° ì‹œë„...');
            
            try {
                const socket = new SockJS('http://localhost:8080/ws-stomp');
                const stompClient = Stomp.over(socket);
                
                // ë””ë²„ê·¸ ë©”ì‹œì§€ í™œì„±í™”
                stompClient.debug = function(str) {
                    log('ğŸ› STOMP Debug: ' + str);
                };
                
                stompClient.connect({}, function(frame) {
                    log('âœ… STOMP ì—°ê²° ì„±ê³µ: ' + frame);
                    stompClient.disconnect();
                }, function(error) {
                    log('âŒ STOMP ì—°ê²° ì‹¤íŒ¨: ' + error);
                });
                
            } catch (error) {
                log('âŒ STOMP ìƒì„± ì‹¤íŒ¨: ' + error);
            }
        }
    </script>
</body>
</html>